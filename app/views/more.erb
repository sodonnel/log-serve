$('#code').append('<%= escape_javascript(erb(:logline, :layout => false, :locals => { :lines => lines })) %>');
$('#container').attr('data-infinite-scroll-position', '<%= log_position %>');
<% if no_more_messages %>
  $('#container').attr('data-infinite-scroll-status', 'end-of-stream');
<% else %>
  $('#container').attr('data-infinite-scroll-status', 'ready');
<% end %>

// TODO - move into function
if ( $('#code tr').size() > 750 ) {
  var oldHeight = $(document).height()
  $('#code tr').slice(0, 250).remove();
  $('html, body').scrollTop($('html, body').scrollTop() + $(document).height() - oldHeight);
  $('#container').attr('data-infinite-scroll-earlier-status', 'ready');
  $('#container').attr('data-infinite-scroll-earlier-position', $('#code tr').first().attr('sp'));
}


